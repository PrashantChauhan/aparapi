# setup initial forest
adding d/d/f
adding d/f
adding f
adding f
adding f
adding f
adding f
# ftrees
.
d/d/t
e/d
t
t/t
# fstatus
[.]

[d/d/t]
M d/d/t/f

[e/d]

[t]

[t/t]
? t/t/f2

[.]

[d/d/t]

[e/d]

[t]

[t/t]

# fclone
[.]
updating to branch default
3 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

# fsnap
adding d/d/f2
--- top-snap1
+++ top-snap2
@@ -1,6 +1,6 @@
 [tree1]
 root = .
-revision = fccf42f55033a9715e9e990fcc1749e3d0d19d39
+revision = bc7d06dbb331e93b327d848dc724e61cd2dc2d66
 
 [tree2]
 root = d/d/t
@@ -16,5 +16,5 @@
 
 [tree5]
 root = t/t
-revision = 5d60830890a20c050332e222b8307bbb70940a3f
+revision = e7ef7301b2ddca4eca0c4e80fe0cc8c943d05645
 
# ftag
[.]

[d/d/t]

[e/d]

[t]

[t/t]

[.]

[d/d/t]

[e/d]

[t]

[t/t]

[.]

[d/d/t]

[e/d]

[t]

[t/t]

tip                                4
barney                             2
wilma                              1
fred                               1

tip                                3
barney                             1
wilma                              0
fred                               0

# fupdate
[.]
0 files updated, 0 files merged, 1 files removed, 0 files unresolved

[d/d/t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

changeset:   0:11d08ba64b67
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     start

changeset:   0:5d60830890a2
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     start

[.]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

0 files updated, 0 files merged, 1 files removed, 0 files unresolved
1 files updated, 0 files merged, 0 files removed, 0 files unresolved
[.]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

0 files updated, 0 files merged, 1 files removed, 0 files unresolved
1 files updated, 0 files merged, 0 files removed, 0 files unresolved
[.]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

0 files updated, 0 files merged, 1 files removed, 0 files unresolved
1 files updated, 0 files merged, 0 files removed, 0 files unresolved
[.]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

0 files updated, 0 files merged, 1 files removed, 0 files unresolved
1 files updated, 0 files merged, 0 files removed, 0 files unresolved
[.]
2 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

changeset:   0:11d08ba64b67
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     start

changeset:   1:e7ef7301b2dd
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     new line

# fseed
updating to branch default
4 files updated, 0 files merged, 0 files removed, 0 files unresolved
[d/d/t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[tree1]
root = .
revision = fccf42f55033a9715e9e990fcc1749e3d0d19d39

[tree1.paths]
default = HGTMP/test-forest/toplevel

[tree2]
root = d/d/t
revision = 11d08ba64b676ed2f87a16089f3a0e5060c7bc36

[tree2.paths]
default = HGTMP/test-forest/toplevel/d/d/t

[tree3]
root = e/d
revision = 87ae3032128b3306de675b7b390bc7b594ed74eb

[tree3.paths]
default = HGTMP/test-forest/toplevel/e/d

[tree4]
root = t
revision = 37c7c7838b045dddb0718588a6318f002f0bed0a

[tree4.paths]
default = HGTMP/test-forest/toplevel/t

[tree5]
root = t/t
revision = 5d60830890a20c050332e222b8307bbb70940a3f

[tree5.paths]
default = HGTMP/test-forest/toplevel/t/t

[tree1]
root = .
revision = fccf42f55033a9715e9e990fcc1749e3d0d19d39
path.default = HGTMP/test-forest/toplevel

[tree2]
root = d/d/t
revision = 11d08ba64b676ed2f87a16089f3a0e5060c7bc36
path.default = HGTMP/test-forest/toplevel/d/d/t

[tree3]
root = e/d
revision = 87ae3032128b3306de675b7b390bc7b594ed74eb
path.default = HGTMP/test-forest/toplevel/e/d

[tree4]
root = t
revision = 37c7c7838b045dddb0718588a6318f002f0bed0a
path.default = HGTMP/test-forest/toplevel/t

[tree5]
root = t/t
revision = 5d60830890a20c050332e222b8307bbb70940a3f
path.default = HGTMP/test-forest/toplevel/t/t

# fpull
[.]
pulling from HGTMP/test-forest/toplevel
searching for changes
no changes found

[d/d/t]
pulling from HGTMP/test-forest/toplevel/d/d/t
searching for changes
no changes found

[e/d]
pulling from HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
pulling from HGTMP/test-forest/toplevel/t
searching for changes
no changes found

[t/t]
pulling from HGTMP/test-forest/toplevel/t/t
searching for changes
no changes found

[.]
pulling from HGTMP/test-forest/toplevel
searching for changes
no changes found

[d/d/t]
pulling from HGTMP/test-forest/toplevel/d/d/t
searching for changes
no changes found

[e/d]
pulling from HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
pulling from HGTMP/test-forest/toplevel/t
searching for changes
no changes found

[t/t]
pulling from HGTMP/test-forest/toplevel/t/t
searching for changes
no changes found

[.]
pulling from HGTMP/test-forest/toplevel
searching for changes
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
pulling from HGTMP/test-forest/toplevel/d/d/t
searching for changes
no changes found

[e/d]
pulling from HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
requesting all changes
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
requesting all changes
adding changesets
adding manifests
adding file changes
added 2 changesets with 2 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

# foutgoing
[.]
comparing with HGTMP/test-forest/toplevel
searching for changes
changeset:   2:ea42b6f87495
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     remove new file


[d/d/t]
comparing with HGTMP/test-forest/toplevel/d/d/t
searching for changes
no changes found

[e/d]
comparing with HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
comparing with HGTMP/test-forest/toplevel/t
searching for changes
no changes found

[t/t]
comparing with HGTMP/test-forest/toplevel/t/t
searching for changes
changeset:   2:c4c5521ca497
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     delete new line


[.]
comparing with HGTMP/test-forest/toplevel
searching for changes
changeset:   2:ea42b6f87495
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     remove new file


[d/d/t]
comparing with HGTMP/test-forest/toplevel/d/d/t
searching for changes
no changes found

[e/d]
comparing with HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
comparing with HGTMP/test-forest/toplevel/t
searching for changes
no changes found

[t/t]
comparing with HGTMP/test-forest/toplevel/t/t
searching for changes
changeset:   2:c4c5521ca497
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     delete new line


[.]
skipped: repository foo not found

[d/d/t]
skipped: repository foo not found

[e/d]
skipped: repository foo not found

[t]
skipped: repository foo not found

[t/t]
skipped: repository foo not found

# fincoming
[.]
comparing with topcopy
searching for changes
changeset:   2:ea42b6f87495
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     remove new file


[d/d/t]
comparing with topcopy/d/d/t
searching for changes
no changes found

[e/d]
comparing with topcopy/e/d
searching for changes
no changes found

[t]
comparing with topcopy/t
searching for changes
no changes found

[t/t]
comparing with topcopy/t/t
searching for changes
changeset:   2:c4c5521ca497
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     delete new line


[.]
comparing with ../topcopy
searching for changes
changeset:   2:ea42b6f87495
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     remove new file


[d/d/t]
comparing with ../topcopy/d/d/t
searching for changes
no changes found

[e/d]
comparing with ../topcopy/e/d
searching for changes
no changes found

[t]
comparing with ../topcopy/t
searching for changes
no changes found

[t/t]
comparing with ../topcopy/t/t
searching for changes
changeset:   2:c4c5521ca497
tag:         tip
user:        test
date:        Thu Jan 01 00:00:00 1970 +0000
summary:     delete new line


[.]
skipped: repository foo not found

[d/d/t]
skipped: repository foo not found

[e/d]
skipped: repository foo not found

[t]
skipped: repository foo not found

[t/t]
skipped: repository foo not found

# fpush
[.]
pushing to HGTMP/test-forest/toplevel
searching for changes
adding changesets
adding manifests
adding file changes
added 1 changesets with 0 changes to 0 files

[d/d/t]
pushing to HGTMP/test-forest/toplevel/d/d/t
searching for changes
no changes found

[e/d]
pushing to HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
pushing to HGTMP/test-forest/toplevel/t
searching for changes
no changes found

[t/t]
pushing to HGTMP/test-forest/toplevel/t/t
searching for changes
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files

# fseed and fpull, missing section
[.]
adding changesets
adding manifests
adding file changes
added 1 changesets with 3 changes to 3 files
updating to branch default
3 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

.
e/d
t
t/t
[e/d]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

.
e/d
t
t/t
[.]
pulling from HGTMP/test-forest/toplevel
adding changesets
adding manifests
adding file changes
added 1 changesets with 3 changes to 3 files
(run 'hg update' to get a working copy)

[e/d]
pulling from HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
pulling from HGTMP/test-forest/toplevel/t
searching for changes
no changes found

[t/t]
pulling from HGTMP/test-forest/toplevel/t/t
searching for changes
no changes found

# fseed and fpull, named section
[.]
adding changesets
adding manifests
adding file changes
added 1 changesets with 3 changes to 3 files
updating to branch default
3 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t/t]
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

.
d/d/t
e/d
t
t/t
[.]
pulling from HGTMP/test-forest/toplevel
searching for changes
no changes found

[d/d/t]
pulling from HGTMP/test-forest/toplevel/d/d/t
searching for changes
no changes found

[e/d]
pulling from HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
pulling from HGTMP/test-forest/toplevel/t
searching for changes
no changes found

[t/t]
pulling from HGTMP/test-forest/toplevel/t/t
searching for changes
no changes found

# fstatus + mq
[.]

[d/d/t]

[e/d]

[t]
warning: 't' has mq patches applied

[t/t]
warning: 't/t' has mq patches applied

[t/t/.hg/patches]
A t/t/.hg/patches/.hgignore
A t/t/.hg/patches/mq-patch
A t/t/.hg/patches/series

# fclone + mq
[.]
updating to branch default
3 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
skipped: 't' has mq patches applied

[t/t]
skipped: 't/t' has mq patches applied

[t/t/.hg/patches]
updating to branch default
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

# fsnap + mq
abort: 't' has mq patches applied
# fpull + mq
[.]
pulling from HGTMP/test-forest/toplevel
searching for changes
no changes found

[d/d/t]
pulling from HGTMP/test-forest/toplevel/d/d/t
searching for changes
no changes found

[e/d]
pulling from HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
skipped: 't' has mq patches applied

[t/t]
skipped: 't/t' has mq patches applied

# fpush + mq
[.]
pushing to HGTMP/test-forest/toplevel
searching for changes
no changes found

[d/d/t]
pushing to HGTMP/test-forest/toplevel/d/d/t
searching for changes
no changes found

[e/d]
pushing to HGTMP/test-forest/toplevel/e/d
searching for changes
no changes found

[t]
skipped: 't' has mq patches applied

[t/t]
skipped: 't/t' has mq patches applied

# fupdate + mq
[.]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[d/d/t]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[e/d]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[t]
skipped: 't' has mq patches applied

[t/t]
skipped: 't/t' has mq patches applied

[t/t/.hg/patches]
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

# walk **/.hg
.
a
.
.hg/h
a
a/.hg/h
.
.hg/h
a
a/.hg/h
.
a
.
a
.
a
# circular trees
[.]
? b

[a]
? a/b
? a/c

[a/a]

# fpull --partial
adding f
adding f
[.]
updating to branch default
0 files updated, 0 files merged, 0 files removed, 0 files unresolved

[a]
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[b]
updating to branch default
1 files updated, 0 files merged, 0 files removed, 0 files unresolved

[.]
pulling from HGTMP/test-forest/partial
no changes found

[a]
pulling from HGTMP/test-forest/partial/a
searching for changes
no changes found

[b]
skipped: new remote repository

[.]
pulling from HGTMP/test-forest/partial
no changes found

[a]
pulling from HGTMP/test-forest/partial/a
searching for changes
no changes found

[b]
skipped: new remote repository

[.]
pulling from HGTMP/test-forest/partial
no changes found

[a]
pulling from HGTMP/test-forest/partial/a
searching for changes
no changes found

[b]
requesting all changes
adding changesets
adding manifests
adding file changes
added 1 changesets with 1 changes to 1 files

